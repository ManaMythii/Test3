<!DOCTYPE html>
<html lang="en" data-bs-theme="dark">
<head>
    <meta charset="UTF-8">
    <title>Excel to Table</title>
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
</head>
<body>
    <div class="container-fluid">
    <h2>JSON Data from File</h2>
    <div id="grid-container"></div>
    </div>
    <script>
        // Fetch the JSON file from the server
        fetch('CYLRankings.json')
            .then(response => response.json())
            .then(data => {
                renderTable(data);
            })
            .catch(err => {
                document.getElementById('table-container').innerHTML = '<div class="alert alert-danger">Could not load JSON file.</div>';
            });

                function renderTable(data) {
                                if (!Array.isArray(data) || data.length === 0) {
                                    document.getElementById('grid-container').innerHTML = '<div class="alert alert-warning">No data found in JSON file.</div>';
                                    return;
                                }
                                const headers = Object.keys(data[0]);
                                    let html = '<div class="container-fluid"><div style="overflow-x:auto;">';
                                    html += '<table class="table table-bordered align-middle mb-0">';
                                    html += '<thead class="table-light"><tr>';
                                    headers.forEach(h => {
                                        html += `<th class="text-nowrap">${h}</th>`;
                                    });
                                    html += '</tr></thead><tbody>';
                                    data.forEach(row => {
                                        html += '<tr>';
                                        headers.forEach(h => {
                                            html += `<td class="text-nowrap">${row[h] ?? ""}</td>`;
                                        });
                                        html += '</tr>';
                                    });
                                    html += '</tbody></table></div></div>';
                                document.getElementById('grid-container').innerHTML = html;
                }
    </script>
</body>
</html>

